/*! For license information please see dacce6ac.9433f873.js.LICENSE.txt */
"use strict";(self.webpackChunkreact_native_website=self.webpackChunkreact_native_website||[]).push([[92367],{41614:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>d});var s=n(24246),i=n(71670);const r={id:"release-testing",title:"How to Test a Release"},o=void 0,a={id:"release-testing",title:"How to Test a Release",description:"These steps needs to be followed by the release crew as part of the release process, to ensure that new versions published have a good level of stability.",source:"@site/contributing/release-testing.md",sourceDirName:".",slug:"/release-testing",permalink:"/contributing/release-testing",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/react-native-website/blob/main/website/contributing/release-testing.md",tags:[],version:"current",lastUpdatedAt:1704504779,formattedLastUpdatedAt:"Jan 6, 2024",frontMatter:{id:"release-testing",title:"How to Test a Release"},sidebar:"contributing",previous:{title:"Release Dependencies",permalink:"/contributing/release-dependencies"},next:{title:"How to Update Upgrade Helper",permalink:"/contributing/updating-upgrade-helper"}},l={},d=[{value:"Pre-requisites",id:"pre-requisites",level:2},{value:"Additional steps for Android",id:"additional-steps-for-android",level:4},{value:"Steps",id:"steps",level:2},{value:"Clean up the local state",id:"clean-up-the-local-state",level:3},{value:"Generating the projects",id:"generating-the-projects",level:3},{value:"Versions older than 71",id:"versions-older-than-71",level:4},{value:"What to test?",id:"what-to-test",level:2},{value:"Test Dimensions",id:"test-dimensions",level:3},{value:"Testing pre-releases (RC) on production apps",id:"testing-pre-releases-rc-on-production-apps",level:2}];function c(e){const t=Object.assign({p:"p",admonition:"admonition",h2:"h2",ul:"ul",li:"li",a:"a",code:"code",pre:"pre",h4:"h4",em:"em",h3:"h3",ol:"ol"},(0,i.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"These steps needs to be followed by the release crew as part of the release process, to ensure that new versions published have a good level of stability."}),"\n",(0,s.jsx)(t.admonition,{type:"info",children:(0,s.jsx)(t.p,{children:"An important element of testing source in the release branch is that this process needs to be preferably be done twice, on two separate machines - there are multiple scenarios in which something might fail on a machine but not on another. By running tests on two computers, we want to reach a step of double confirmation that everything works fine."})}),"\n",(0,s.jsx)(t.h2,{id:"pre-requisites",children:"Pre-requisites"}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsx)(t.p,{children:"Currently, this flow can only be done on macOS machines."})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["One CircleCI personal API token - see ",(0,s.jsx)(t.a,{href:"https://circleci.com/docs/managing-api-tokens#creating-a-personal-api-token",children:"here"})," how to set one."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Have a clone of ",(0,s.jsx)(t.code,{children:"react-native"})," repo and be on the release branch (",(0,s.jsx)(t.code,{children:"0.XX-stable"}),")."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"# Checkout relevant branch\ngit checkout 0.72-stable\n\n# Optional: you might need a .watchmanconfig because `npm start` would fail without it.\necho '{}' > .watchmanconfig\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Have Android and iOS development environment set-up. Follow instructions for ",(0,s.jsx)(t.code,{children:"React Native CLI quickstart"})," for macOS/iOS and macOS/Android from the ",(0,s.jsx)(t.a,{href:"/docs/environment-setup",children:"Environment Setup"})," guide."]}),"\n",(0,s.jsx)(t.h4,{id:"additional-steps-for-android",children:"Additional steps for Android"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Gradle should now install ",(0,s.jsx)(t.a,{href:"https://github.com/facebook/react-native/blob/main/template/android/build.gradle",children:"the appropriate NDK"}),". Verify that you have in your path the ",(0,s.jsx)(t.code,{children:"ANDROID_NDK"})," variable, pointing to it."]}),"\n",(0,s.jsxs)(t.li,{children:["In case you are on macOS Catalina (or higher), you might also need to run ",(0,s.jsx)(t.code,{children:"sudo xattr -r -d com.apple.quarantine /path/to/ndk"})," to avoid the e2e script to fail. (",(0,s.jsx)(t.em,{children:"That said, this should not happen anymore since from NDK 21 and higher the Android team started signing the NDK."}),")"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"steps",children:"Steps"}),"\n",(0,s.jsx)(t.h3,{id:"clean-up-the-local-state",children:"Clean up the local state"}),"\n",(0,s.jsx)(t.p,{children:"When testing locally, we want to ensure that we start from a clean slate to avoid caches polluting our testing."}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Delete ",(0,s.jsx)(t.code,{children:"RNTester"})," and ",(0,s.jsx)(t.code,{children:"RNTestProject"})," from your Android emulator and iOS simulator if leftover from previous test."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Remove any temporary files from the ",(0,s.jsx)(t.code,{children:"react-native"})," repo:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:" git clean -fdx\n"})}),"\n",(0,s.jsxs)(t.p,{children:["For ",(0,s.jsx)(t.code,{children:"main"})," branch, and versions of RN >=0.71, you can instead use ",(0,s.jsx)(t.code,{children:"yarn test-e2e-local-clean"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Install dependencies:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:" yarn install\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"generating-the-projects",children:"Generating the projects"}),"\n",(0,s.jsxs)(t.p,{children:["The local testing for a release consist of running the ",(0,s.jsx)(t.a,{href:"https://github.com/facebook/react-native/tree/main/packages/rn-tester",children:"test project"})," of the react-native repository, ",(0,s.jsx)(t.code,{children:"RNTester"}),", which contains an in-depth list of components implementations, and generating a fresh new project based on the local code, ",(0,s.jsx)(t.code,{children:"RNTestProject"}),", that will simulate accurately how a ",(0,s.jsx)(t.code,{children:"react-native init"})," project will behave."]}),"\n",(0,s.jsx)(t.p,{children:"To generate the the right project with the specific configuration desired, you can use the command"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"yarn test-e2e-local [options]\n"})}),"\n",(0,s.jsx)(t.p,{children:"Followed by the wanted options:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'  --help          Show help                                            [boolean]\n  --version       Show version number                                  [boolean]\n  -t, --target      [choices: "RNTester", "RNTestProject"] [default: "RNTester"]\n  -p, --platform                    [choices: "iOS", "Android"] [default: "iOS"]\n  -h, --hermes                                         [boolean] [default: true]\n  -c, --circleciToken                                                   [string]\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Using the ",(0,s.jsx)(t.code,{children:"-c <your-token>"})," option is recommended, as the script will download the required artifacts from CircleCI, instead of having to build from source reducing the testing time.\nThere are a couple of extra requirements to make this flow work:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"the CI must have run at least once in the current branch. We need to download artifacts generated by CircleCI, so we need to have at least one run of the CI."}),"\n",(0,s.jsx)(t.li,{children:"The relevant jobs must have been finished. The required jobs depends on the task you are about to tests:"}),"\n"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"if you are testing RNTester on iOS, it has to download Hermes for iOS. So the job that produces it must have finished successfully"}),"\n",(0,s.jsx)(t.li,{children:"if you are testing RNTester on Android, it has to download the right APK (JSC or Hermes). So the job that produces the APKs must have finished successfully."}),"\n",(0,s.jsx)(t.li,{children:"if you are testing RNTestProject, it has to download the maven prebuilts and the Hermes engine for iOS. So the jobs that produce those artifacts must have finished successfully."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Anyway, if any of those prerequisites is not met, the script should output a proper error message."}),"\n",(0,s.jsxs)(t.p,{children:["If you need to build React Native from source, you can skip the ",(0,s.jsx)(t.code,{children:"-c"})," parameter. By not passing the CircleCI token, the script falls back to the previous flow, building everything locally."]}),"\n",(0,s.jsx)(t.h4,{id:"versions-older-than-71",children:"Versions older than 71"}),"\n",(0,s.jsxs)(t.p,{children:["You need to use the interactive script run you through the different variants in ",(0,s.jsx)(t.a,{href:"#test-dimensions",children:"Test Dimensions"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"./scripts/test-manual-e2e.sh\n"})}),"\n",(0,s.jsx)(t.p,{children:"This script will ask you to select which platform and which project you want to test, and then to execute a series of extra steps during the process. Bear in mind, when testing RNTester on Android, you need to start the Android emulator ahead of time or it will fail."}),"\n",(0,s.jsx)(t.h2,{id:"what-to-test",children:"What to test?"}),"\n",(0,s.jsx)(t.p,{children:"Aside from verifying that the building process is successful, once the app spawn by the script is up and running, we want to run a series of manual tests to ensure that some core functionalities work, like Fast Refresh and the Flipper debugger."}),"\n",(0,s.jsxs)(t.p,{children:["In the ",(0,s.jsx)(t.code,{children:"RNTester"})," you want to also play around with the app and try different components: some important onces are ",(0,s.jsx)(t.code,{children:"Flatlist"}),", ",(0,s.jsx)(t.code,{children:"Image"}),' and the "New Architecture Component" (should be the very last one in the list).']}),"\n",(0,s.jsx)(t.h3,{id:"test-dimensions",children:"Test Dimensions"}),"\n",(0,s.jsx)(t.p,{children:"To ensure that we cover the most use cases, we need to ensure we test all these different combination of configurations:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"RNTester + iOS + Hermes"}),"\n",(0,s.jsx)(t.li,{children:"RNTester + iOS + JSC"}),"\n",(0,s.jsx)(t.li,{children:"RNTester + Android + Hermes"}),"\n",(0,s.jsx)(t.li,{children:"RNTester + Android + JSC"}),"\n",(0,s.jsx)(t.li,{children:"RNTestProject + iOS + Hermes"}),"\n",(0,s.jsx)(t.li,{children:"RNTestProject + iOS + JSC"}),"\n",(0,s.jsx)(t.li,{children:"RNTestProject + Android + Hermes"}),"\n",(0,s.jsx)(t.li,{children:"RNTestProject + Android + JSC"}),"\n"]}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsxs)(t.p,{children:["Bear in mind that RNTester project is already onboarded in the new architecture. ",(0,s.jsx)(t.code,{children:"RNTestProject"})," is not - new architecture mode needs to be ",(0,s.jsx)(t.a,{href:"/docs/the-new-architecture/use-app-template#enable-the-new-architecture",children:"enabled"})," and tested separately."]})}),"\n",(0,s.jsx)(t.h2,{id:"testing-pre-releases-rc-on-production-apps",children:"Testing pre-releases (RC) on production apps"}),"\n",(0,s.jsxs)(t.p,{children:['During the Release Candidate (RC) phase of a release cycle, we ask for the community to set as dependency in their apps the latest RC available and report in the related "Road to 0.XX" how it performs (',(0,s.jsx)(t.a,{href:"https://github.com/reactwg/react-native-releases/discussions/26",children:"example"}),")."]}),"\n",(0,s.jsx)(t.p,{children:"To help provide the relevant information, we have prepared this template they can use as blueprint for what is important to test - they can copy/pasted it in a comment and fill it accordingly."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-markdown",children:"| Link to branch:                      |                         |\n| -----------------------------------  | :---------------------- |\n| **Project info**                     |                         |\n| Name                                 |                         |\n| Starting RN version                  | <add me, ex. RN 0.65.1> |\n| Hermes on iOS                        | yes/no                  |\n| Hermes on Android                    | yes/no                  |\n| **Tested - iOS**                     |                         |\n| Fast Refresh                         | \u2705/\ud83d\udea8/\ud83d\ude45\u200d\u2642\ufe0f                 |\n| Debug/dev build on Simulator         | \u2705/\ud83d\udea8/\ud83d\ude45\u200d\u2642\ufe0f                 |\n| Debug/dev build on Device            | \u2705/\ud83d\udea8/\ud83d\ude45\u200d\u2642\ufe0f                 |\n| Production build                     | \u2705/\ud83d\udea8/\ud83d\ude45\u200d\u2642\ufe0f                 |\n| Debugger (Hermes)                    | \u2705/\ud83d\udea8/\ud83d\ude45\u200d\u2642\ufe0f                 |\n| Deploy to TestFlight                 | \u2705/\ud83d\udea8/\ud83d\ude45\u200d\u2642\ufe0f                 |\n| **Tested - Android**                 |                         |\n| Fast Refresh                         | \u2705/\ud83d\udea8/\ud83d\ude45\u200d\u2642\ufe0f                 |\n| Debug/dev build on Emulator          | \u2705/\ud83d\udea8/\ud83d\ude45\u200d\u2642\ufe0f                 |\n| Debug/dev build on Device            | \u2705/\ud83d\udea8/\ud83d\ude45\u200d\u2642\ufe0f                 |\n| Production build                     | \u2705/\ud83d\udea8/\ud83d\ude45\u200d\u2642\ufe0f                 |\n| Debugger (Hermes)                    | \u2705/\ud83d\udea8/\ud83d\ude45\u200d\u2642\ufe0f                 |\n| **Optional - Deprecated in 0.73**    |                         |\n| Chrome remote debugger (Android/iOS) | \u2705/\ud83d\udea8/\ud83d\ude45\u200d\u2642\ufe0f                 |\n| Flipper debugger (Android/iOS)       | \u2705/\ud83d\udea8/\ud83d\ude45\u200d\u2642\ufe0f                 |\n"})})]})}const h=function(e={}){const{wrapper:t}=Object.assign({},(0,i.ah)(),e.components);return t?(0,s.jsx)(t,Object.assign({},e,{children:(0,s.jsx)(c,e)})):c(e)}},71426:(e,t,n)=>{var s=n(27378),i=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,n){var s,r={},d=null,c=null;for(s in void 0!==n&&(d=""+n),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,s)&&!l.hasOwnProperty(s)&&(r[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===r[s]&&(r[s]=t[s]);return{$$typeof:i,type:e,key:d,ref:c,props:r,_owner:a.current}}t.Fragment=r,t.jsx=d,t.jsxs=d},24246:(e,t,n)=>{e.exports=n(71426)},71670:(e,t,n)=>{n.d(t,{Zo:()=>a,ah:()=>r});var s=n(27378);const i=s.createContext({});function r(e){const t=s.useContext(i);return s.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}const o={};function a({components:e,children:t,disableParentContext:n}){let a;return a=n?"function"==typeof e?e({}):e||o:r(e),s.createElement(i.Provider,{value:a},t)}}}]);