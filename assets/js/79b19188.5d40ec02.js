/*! For license information please see 79b19188.5d40ec02.js.LICENSE.txt */
"use strict";(self.webpackChunkreact_native_website=self.webpackChunkreact_native_website||[]).push([[51893],{39544:(e,t,n)=>{n.d(t,{ZP:()=>i});var r=n(24246),a=n(71670);function s(e){const t=Object.assign({admonition:"admonition",p:"p"},(0,a.ah)(),e.components);return(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsx)(t.p,{children:"Since testing is a time consuming activity (>1 hrs) it is recommended that the release crew coordinates on the steps above then do testing on at least two separate systems in an async way."})})}const i=function(e={}){const{wrapper:t}=Object.assign({},(0,a.ah)(),e.components);return t?(0,r.jsx)(t,Object.assign({},e,{children:(0,r.jsx)(s,e)})):s(e)}},85879:(e,t,n)=>{n.d(t,{ZP:()=>i});var r=n(24246),a=n(71670);function s(e){const t=Object.assign({admonition:"admonition",p:"p",code:"code"},(0,a.ah)(),e.components);return(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["For versions older than 0.70, you need to run ",(0,r.jsx)(t.code,{children:"./scripts/bump-oss-version.js"})," instead."]})})}const i=function(e={}){const{wrapper:t}=Object.assign({},(0,a.ah)(),e.components);return t?(0,r.jsx)(t,Object.assign({},e,{children:(0,r.jsx)(s,e)})):s(e)}},6995:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var r=n(24246),a=n(71670),s=n(39544),i=n(85879);const o={id:"release-stable-patch",title:"Minor Stable Patches"},c=void 0,l={id:"release-stable-patch",title:"Minor Stable Patches",description:"Documents in this section go over steps to run different types of React Native release updates. Its intended audience is those in relevant release roles.",source:"@site/contributing/release-stable-patch.md",sourceDirName:".",slug:"/release-stable-patch",permalink:"/contributing/release-stable-patch",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/react-native-website/blob/main/website/contributing/release-stable-patch.md",tags:[],version:"current",lastUpdatedAt:1704504779,formattedLastUpdatedAt:"Jan 6, 2024",frontMatter:{id:"release-stable-patch",title:"Minor Stable Patches"},sidebar:"contributing",previous:{title:"Minor Stable 0.Y.0",permalink:"/contributing/release-stable-minor"},next:{title:"Troubleshooting",permalink:"/contributing/release-troubleshooting"}},h={},d=[{value:"Pre-requisites",id:"pre-requisites",level:3},{value:"1. Check out the latest version from release branch",id:"1-check-out-the-latest-version-from-release-branch",level:3},{value:"2. Bump monorepo packages",id:"2-bump-monorepo-packages",level:3},{value:"3. Test the current changes",id:"3-test-the-current-changes",level:3},{value:"4. Run <code>trigger-react-native-release</code> script",id:"4-run-trigger-react-native-release-script",level:3},{value:"5. Watch CircleCI to ensure right jobs are being triggered",id:"5-watch-circleci-to-ensure-right-jobs-are-being-triggered",level:3},{value:"6. Create a PR of the changelog using the generator",id:"6-create-a-pr-of-the-changelog-using-the-generator",level:3},{value:"7. Create GitHub Release",id:"7-create-github-release",level:3},{value:"8. Upload prebuilt Hermes binary",id:"8-upload-prebuilt-hermes-binary",level:3},{value:"9. Create a new patch discussion post using template below",id:"9-create-a-new-patch-discussion-post-using-template-below",level:3},{value:"10. Update &quot;should we release 0.Y.Z?&quot; discussion post",id:"10-update-should-we-release-0yz-discussion-post",level:3},{value:"11. Verify that Upgrade Helper GitHub action has fired",id:"11-verify-that-upgrade-helper-github-action-has-fired",level:3},{value:"12. Communicate the new release",id:"12-communicate-the-new-release",level:3}];function u(e){const t=Object.assign({admonition:"admonition",p:"p",a:"a",h3:"h3",ul:"ul",li:"li",pre:"pre",code:"code",strong:"strong"},(0,a.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["Documents in this section go over steps to run different types of React Native release updates. Its intended audience is those in ",(0,r.jsx)(t.a,{href:"/contributing/release-roles-responsibilities",children:"relevant release roles"}),"."]})}),"\n",(0,r.jsx)(t.h3,{id:"pre-requisites",children:"Pre-requisites"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:['You have some pick requests that qualify for a patch release in the "should we release 0.Y.Z?" ',(0,r.jsx)(t.a,{href:"https://github.com/reactwg/react-native-releases/discussions",children:"discussion"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:["Write access to ",(0,r.jsx)(t.a,{href:"https://github.com/facebook/react-native",children:"react-native"})," repository."]}),"\n",(0,r.jsxs)(t.li,{children:["Write access to ",(0,r.jsx)(t.a,{href:"https://github.com/reactwg/react-native-releases",children:"releases"})," repository."]}),"\n",(0,r.jsxs)(t.li,{children:["One CircleCI personal API token - see ",(0,r.jsx)(t.a,{href:"https://circleci.com/docs/2.0/managing-api-tokens/#creating-a-personal-api-token",children:"here"})," how to set one."]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"1-check-out-the-latest-version-from-release-branch",children:"1. Check out the latest version from release branch"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"# Be on relevant release branch\n# update the stable branch with tags\ngit pull origin <release-branch> --tags\n\n# cherry pick relevant commits\ngit cherry-pick <commit>\n"})}),"\n",(0,r.jsx)(t.h3,{id:"2-bump-monorepo-packages",children:"2. Bump monorepo packages"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"For 0.72 and higher:"})}),"\n",(0,r.jsx)(t.p,{children:"Update all packages in the monorepo that were modified by the cherry picks. You can do it by running:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:"yarn bump-all-updated-packages # All the package bumps must be on the patch level\ngit push origin 0.XX-stable\n"})}),"\n",(0,r.jsx)(t.p,{children:"After pushing, the CI will take care to publish the new packages automatically."}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"For 0.71:"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:"yarn bump-all-updated-packages\ngit push origin 0.71-stable\n"})}),"\n",(0,r.jsx)(t.p,{children:"This will trigger a CI pipeline that will publish the changed packages. Once those packages are published (the new versions are on npm), run:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:"yarn align-package-versions\n"})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"For 0.70:"}),"\nFor version 0.70, packages must be released manually by a Meta engineer."]}),"\n",(0,r.jsx)(t.h3,{id:"3-test-the-current-changes",children:"3. Test the current changes"}),"\n",(0,r.jsxs)(t.p,{children:["Before continuing further, follow the ",(0,r.jsx)(t.a,{href:"/contributing/release-testing",children:"testing guide"})," to ensure the source code doesn't have any major issues."]}),"\n",(0,r.jsx)(s.ZP,{}),"\n",(0,r.jsxs)(t.h3,{id:"4-run-trigger-react-native-release-script",children:["4. Run ",(0,r.jsx)(t.code,{children:"trigger-react-native-release"})," script"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:'# once verified all the cherry-picked commits, we can push them to remote\ngit push\n\n# run a script to bump the version\n# If you are doing this patch release for the current latest minor, then mark it as "latest"\nyarn trigger-react-native-release --to-version x.y.z --token <YOUR_CIRCLE_CI_TOKEN>\n'})}),"\n",(0,r.jsx)(i.ZP,{}),"\n",(0,r.jsx)(t.h3,{id:"5-watch-circleci-to-ensure-right-jobs-are-being-triggered",children:"5. Watch CircleCI to ensure right jobs are being triggered"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["Once you have run the bump script script, head to CircleCI and you should see under the releases workflow, a ",(0,r.jsx)(t.code,{children:"prepare-package-for-release"})," job."]}),"\n",(0,r.jsxs)("figure",{children:[(0,r.jsx)("img",{width:"400",alt:"CircleCI showing publish release",src:"https://user-images.githubusercontent.com/1309636/150040711-cfbc2fe3-91eb-42b9-bd06-de2aa7fb94ea.png"}),(0,r.jsx)("figcaption",{children:"CircleCI showing publish release."})]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:["Once complete you should be able to run ",(0,r.jsx)(t.code,{children:"npm view react-native"})," and verify that under the ",(0,r.jsx)(t.code,{children:"latest"})," tag, the version is the expected release version."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"npm view react-native\n...\ndist-tags:\nlatest: 0.Y.Z            next: 0.Y.0-rc.X         nightly: 0.0.0-f617e022c\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"6-create-a-pr-of-the-changelog-using-the-generator",children:"6. Create a PR of the changelog using the generator"}),"\n",(0,r.jsxs)(t.p,{children:["To generate the changelog, we rely on a dedicated tool called ",(0,r.jsx)(t.a,{href:"https://github.com/microsoft/rnx-kit/tree/main/incubator/rn-changelog-generator",children:(0,r.jsx)(t.code,{children:"@rnx-kit/rn-changelog-generator"})})," that will parse the custom changelog messages that contributors write in their PRs."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"# Run following with the stable release as base, and your rc.0 version\nnpx @rnx-kit/rn-changelog-generator --base v[LATEST_STABLE]--compare v[YOUR_NEW_MINOR] \\\n--repo ~/react-native --changelog ~/react-native/CHANGELOG.md\n\n# example against 0.68.2 and 0.68.3\nnpx @rnx-kit/rn-changelog-generator --base v0.68.2 --compare v0.68.3 \\\n--repo ~/react-native --changelog ~/react-native/CHANGELOG.md\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Create a pull request of this change to ",(0,r.jsx)(t.code,{children:"react-native"})," repo and add the ",(0,r.jsx)(t.code,{children:"Changelog"})," label."]}),"\n",(0,r.jsx)(t.h3,{id:"7-create-github-release",children:"7. Create GitHub Release"}),"\n",(0,r.jsx)(t.p,{children:"Use template below for the GitHub Release:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-markdown",children:"\x3c!-- Template for a stable patch --\x3e\n\n\x3c!-- You can run `npx @rnx-kit/rn-changelog-generator --base v0.66.0 --compare v0.66.1 --repo path-to-repository/react-native --changelog path-to-repository/react-native/CHANGELOG.md` to generate the markdown for the cherry-picked changes. Make sure to use the right tags in the command and create a new PR with the changes generated by the changelog generator. You can read more about the changelog generator [here](https://github.com/microsoft/rnx-kit/tree/main/incubator/rn-changelog-generator). --\x3e\n\n- TODO Enumerate picks. \x3c!-- use the changelog generated text for this section --\x3e\n\n---\n\nYou can participate in the conversation on the status of this release in this [discussion](TODO: your discussion link)\n\n---\n\nTo help you upgrade to this version, you can use the [upgrade helper](https://react-native-community.github.io/upgrade-helper/) \u269b\ufe0f\n\n---\n\nYou can find the whole changelog history in the [changelog.md file](https://github.com/facebook/react-native/blob/main/CHANGELOG.md).\n"})}),"\n",(0,r.jsx)(t.h3,{id:"8-upload-prebuilt-hermes-binary",children:"8. Upload prebuilt Hermes binary"}),"\n",(0,r.jsxs)(t.p,{children:["In the ",(0,r.jsx)(t.code,{children:"publish_release"})," CI workflow, the ",(0,r.jsx)(t.code,{children:"build_hermes_macos"})," step produces a ",(0,r.jsx)(t.code,{children:"tmp/hermes/output/hermes-runtime-darwin-vx.y.z.tar.gz"})," artifact, for example ",(0,r.jsx)(t.a,{href:"https://app.circleci.com/pipelines/github/facebook/react-native/13933/workflows/5f2ad198-2264-4e7e-8c62-7b28e97532d8/jobs/262322/artifacts",children:"here"})," are the artifacts for ",(0,r.jsx)(t.code,{children:"0.69.0"})," release. Download it and attach it to the GitHub release."]}),"\n",(0,r.jsx)(t.h3,{id:"9-create-a-new-patch-discussion-post-using-template-below",children:"9. Create a new patch discussion post using template below"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-markdown",children:"\x3c!-- Template for new patch --\x3e\n\n# Should we release 0.67.1?\n\nCurrent Release: [0.67.0](https://github.com/facebook/react-native/releases/tag/v0.67.0)\n\nConversations on this thread are limited:\n\n- [major release issues](https://reactnative.dev/contributing/release-faq#what-is-release-blocking).\n- [qualified cherry-pick requests](https://reactnative.dev/contributing/release-faq#what-is-a-qualified-pick-request) of commits on main that [did not make the previous patch version](https://reactnative.dev/contributing/release-faq#how-do-i-know-if-my-fixfeature-is-in-a-certain-release).\n\nPlease include a link to the specific commit on main to be cherry-picked, for example: [facebook/react-native@bd2b7d6](https://github.com/facebook/react-native/commit/20b0eba581a00e5e7e300f6377379b836617c147)\n\nIn other words, if you cannot point to a particular commit on main, then your request likely belongs as a new issue.\nIf the issue is a [major release issues](https://reactnative.dev/contributing/release-faq#what-is-release-blocking), please reference the issue here.\n\n---\n\n#### List of qualified picks\n\n\x3c!-- Keep these in chronological order in time of commit --\x3e\n\n1.\n\n#### Local commits to backport to main\n\n1.\n"})}),"\n",(0,r.jsx)(t.h3,{id:"10-update-should-we-release-0yz-discussion-post",children:'10. Update "should we release 0.Y.Z?" discussion post'}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Label it ",(0,r.jsx)(t.code,{children:"Released"}),"."]}),"\n",(0,r.jsx)(t.li,{children:"Update the text body saying the patch has been released and link to new patch discussion."}),"\n",(0,r.jsx)(t.li,{children:"Lock the discussion."}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"11-verify-that-upgrade-helper-github-action-has-fired",children:"11. Verify that Upgrade Helper GitHub action has fired"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["You should see a ",(0,r.jsx)(t.a,{href:"https://github.com/react-native-community/rn-diff-purge/actions",children:"new publish job here"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:["Once it has finished, you should be able to see that the ",(0,r.jsx)(t.a,{href:"https://react-native-community.github.io/upgrade-helper/",children:"Upgrade Helper"})," presents the option to target the new minor."]}),"\n",(0,r.jsxs)(t.li,{children:["If not, check out the guide on ",(0,r.jsx)(t.a,{href:"/contributing/updating-upgrade-helper",children:"how to update Upgrade Helper"}),"."]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"12-communicate-the-new-release",children:"12. Communicate the new release"}),"\n",(0,r.jsx)(t.p,{children:"Once all the steps above have been completed, it's time to signal to the community that latest minor is available! Do so in the following channels:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"https://twitter.com/reactnative",children:"@reactnative"})," on twitter (with a link to the GitHub release)"]}),"\n",(0,r.jsxs)(t.li,{children:["RN Discord ",(0,r.jsx)(t.code,{children:"#releases-coordination"})]}),"\n"]})]})}const p=function(e={}){const{wrapper:t}=Object.assign({},(0,a.ah)(),e.components);return t?(0,r.jsx)(t,Object.assign({},e,{children:(0,r.jsx)(u,e)})):u(e)}},71426:(e,t,n)=>{var r=n(27378),a=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,s={},l=null,h=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(h=t.ref),t)i.call(t,r)&&!c.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:a,type:e,key:l,ref:h,props:s,_owner:o.current}}t.Fragment=s,t.jsx=l,t.jsxs=l},24246:(e,t,n)=>{e.exports=n(71426)},71670:(e,t,n)=>{n.d(t,{Zo:()=>o,ah:()=>s});var r=n(27378);const a=r.createContext({});function s(e){const t=r.useContext(a);return r.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}const i={};function o({components:e,children:t,disableParentContext:n}){let o;return o=n?"function"==typeof e?e({}):e||i:s(e),r.createElement(a.Provider,{value:o},t)}}}]);