/*! For license information please see b2622f06.9f33997e.js.LICENSE.txt */
"use strict";(self.webpackChunkreact_native_website=self.webpackChunkreact_native_website||[]).push([[41571],{67877:(e,t,n)=>{n.d(t,{ZP:()=>l});var r=n(24246),a=n(71670);function i(e){const t=Object.assign({admonition:"admonition",p:"p",strong:"strong",a:"a"},(0,a.ah)(),e.components);return(0,r.jsxs)(t.admonition,{type:"caution",children:[(0,r.jsxs)(t.p,{children:["This documentation is still ",(0,r.jsx)(t.strong,{children:"experimental"})," and details are subject to changes as we iterate. Feel free to share your feedback on the ",(0,r.jsx)(t.a,{href:"https://github.com/reactwg/react-native-new-architecture/discussions/8",children:"discussion inside the working group"})," for this page."]}),(0,r.jsxs)(t.p,{children:["Moreover, it contains several ",(0,r.jsx)(t.strong,{children:"manual steps"}),". Please note that this won't be representative of the final developer experience once the New Architecture is stable. We're working on tools, templates and libraries to help you get started fast on the New Architecture, without having to go through the whole setup."]})]})}const l=function(e={}){const{wrapper:t}=Object.assign({},(0,a.ah)(),e.components);return t?(0,r.jsx)(t,Object.assign({},e,{children:(0,r.jsx)(i,e)})):i(e)}},60206:(e,t,n)=>{n.d(t,{ZP:()=>l});var r=n(24246),a=n(71670);function i(e){const t=Object.assign({blockquote:"blockquote",p:"p",code:"code",pre:"pre"},(0,a.ah)(),e.components);return(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:["If you previously installed a global ",(0,r.jsx)(t.code,{children:"react-native-cli"})," package, please remove it as it may cause unexpected issues:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:"npm uninstall -g react-native-cli @react-native-community/cli\n"})}),"\n"]})}const l=function(e={}){const{wrapper:t}=Object.assign({},(0,a.ah)(),e.components);return t?(0,r.jsx)(t,Object.assign({},e,{children:(0,r.jsx)(i,e)})):i(e)}},21189:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>d,default:()=>m,frontMatter:()=>u,metadata:()=>h,toc:()=>b});var r=n(24246),a=n(71670),i=n(48375),l=n(86386),o=n(11674),s=n(60206),c=n(67877);const u={id:"use-app-template",title:"Creating a New Architecture App"},d=void 0,h={id:"the-new-architecture/use-app-template",title:"Creating a New Architecture App",description:"This page will help you create a new React Native app that uses the New Architecture.",source:"@site/versioned_docs/version-0.72/the-new-architecture/use-app-template.md",sourceDirName:"the-new-architecture",slug:"/the-new-architecture/use-app-template",permalink:"/docs/0.72/the-new-architecture/use-app-template",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/react-native-website/blob/main/website/../docs/the-new-architecture/use-app-template.md",tags:[],version:"0.72",lastUpdatedAt:1704504779,formattedLastUpdatedAt:"Jan 6, 2024",frontMatter:{id:"use-app-template",title:"Creating a New Architecture App"},sidebar:"docs",previous:{title:"Why a New Architecture",permalink:"/docs/0.72/the-new-architecture/why"},next:{title:"What Composes the New Architecture",permalink:"/docs/0.72/the-new-architecture/pillars"}},p={},b=[{value:"Development Environment",id:"development-environment",level:2},{value:"Creating a New Application",id:"creating-a-new-application",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Enable Hermes",id:"enable-hermes",level:3},{value:"Enable the New Architecture",id:"enable-the-new-architecture",level:3},{value:"Target OS",id:"target-os",level:4},{value:"Troubleshooting",id:"troubleshooting",level:4},{value:"<code>react-native run-ios</code> fails",id:"react-native-run-ios-fails",level:5},{value:"Confirming the New Architecture is in Use",id:"confirming-the-new-architecture-is-in-use",level:3},{value:"Want to Know More?",id:"want-to-know-more",level:3}];function f(e){const t=Object.assign({p:"p",h2:"h2",a:"a",strong:"strong",admonition:"admonition",pre:"pre",code:"code",h3:"h3",h4:"h4",h5:"h5",ol:"ol",li:"li",ul:"ul"},(0,a.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.ZP,{}),"\n",(0,r.jsx)(t.p,{children:"This page will help you create a new React Native app that uses the New Architecture."}),"\n",(0,r.jsx)(t.h2,{id:"development-environment",children:"Development Environment"}),"\n",(0,r.jsxs)(t.p,{children:["Before continuing, make sure you've followed all the steps in the ",(0,r.jsx)(t.a,{href:"/docs/0.72/environment-setup",children:"Setting up the development environment"})," section under the ",(0,r.jsx)(t.strong,{children:"React Native CLI Quickstart"})," tab."]}),"\n",(0,r.jsxs)(t.p,{children:["If following the setup guide, stop when you reach the section ",(0,r.jsx)(t.strong,{children:"Running your React Native Application"}),", and resume following this guide."]}),"\n",(0,r.jsx)(t.admonition,{type:"caution",children:(0,r.jsx)(t.p,{children:"If you're using Expo, you can't enable the New Architecture at the moment and will have to wait for a future release of the Expo SDK."})}),"\n",(0,r.jsx)(t.h2,{id:"creating-a-new-application",children:"Creating a New Application"}),"\n",(0,r.jsx)(s.ZP,{}),"\n",(0,r.jsx)(t.p,{children:"If you already have your development environment set up, create a new React Native project from the template:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:"npx react-native@latest init AwesomeProject\n"})}),"\n",(0,r.jsx)(t.admonition,{type:"caution",children:(0,r.jsx)(t.p,{children:"The New Architecture is available in React Native version 0.68 or later."})}),"\n",(0,r.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(t.p,{children:"Follow the steps below to enable the New Architecture and build the app."}),"\n",(0,r.jsx)(t.h3,{id:"enable-hermes",children:"Enable Hermes"}),"\n",(0,r.jsxs)(t.p,{children:["Hermes is an open-source JavaScript engine optimized for React Native. ",(0,r.jsx)(t.a,{href:"https://github.com/reactwg/react-native-new-architecture/discussions/4",children:"Hermes will be the default engine in the future"}),", and we highly recommend you use it."]}),"\n",(0,r.jsxs)(t.p,{children:["Please ",(0,r.jsx)(t.a,{href:"/docs/0.72/hermes",children:"follow the instructions on the React Native website"})," to enable Hermes in your application."]}),"\n",(0,r.jsx)(t.h3,{id:"enable-the-new-architecture",children:"Enable the New Architecture"}),"\n",(0,r.jsx)(t.h4,{id:"target-os",children:"Target OS"}),"\n",(0,r.jsxs)(i.Z,{groupId:"platform",queryString:!0,defaultValue:o.Z.defaultPlatform,values:o.Z.platforms,className:"pill-tabs",children:[(0,r.jsxs)(l.Z,{value:"ios",children:[(0,r.jsxs)(t.p,{children:["Navigate to the ",(0,r.jsx)(t.code,{children:"ios"})," directory and run the following:"]}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:"# from `ios` directory\nbundle install && RCT_NEW_ARCH_ENABLED=1 bundle exec pod install\n"})}),(0,r.jsx)(t.p,{children:"Then build and run the app as usual:"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:"yarn ios\n"})}),(0,r.jsxs)(t.admonition,{type:"note",children:[(0,r.jsxs)(t.p,{children:["You will need to run ",(0,r.jsx)(t.code,{children:"pod install"})," each time a dependency with native code changes. Make this command easier to run by adding it to ",(0,r.jsx)(t.code,{children:"scripts"})," to your project's ",(0,r.jsx)(t.code,{children:"package.json"})," file:"]}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:'"scripts": {\n  "pod-install": "RCT_NEW_ARCH_ENABLED=1 bundle exec pod install"\n}\n'})}),(0,r.jsxs)(t.p,{children:["and run it with ",(0,r.jsx)(t.code,{children:"yarn pod-install"}),". Note that ",(0,r.jsx)(t.code,{children:"bundle install"})," does not need to run a second time, as long as the Gemfile has not changed."]})]}),(0,r.jsx)(t.h4,{id:"troubleshooting",children:"Troubleshooting"}),(0,r.jsxs)(t.h5,{id:"react-native-run-ios-fails",children:[(0,r.jsx)(t.code,{children:"react-native run-ios"})," fails"]}),(0,r.jsxs)(t.p,{children:["If you see a build failure from ",(0,r.jsx)(t.code,{children:"react-native run-ios"}),", there may be cached files from a previous build with the old architecture. Clean the build cache and try again:"]}),(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["Open the project ",(0,r.jsx)(t.code,{children:"ios/project.xcworkspace"})," in Xcode"]}),"\n",(0,r.jsx)(t.li,{children:"In XCode, choose Product > Clean Build Folder"}),"\n",(0,r.jsxs)(t.li,{children:["In the project directory, remove the ",(0,r.jsx)(t.code,{children:"ios/Podfile.lock"})," file and ",(0,r.jsx)(t.code,{children:"ios/Pods"})," directory: ",(0,r.jsx)(t.code,{children:"rm -rf ios/Podfile.lock ios/Pods"})]}),"\n",(0,r.jsxs)(t.li,{children:["Re-run ",(0,r.jsx)(t.code,{children:"yarn pod-install"})," and ",(0,r.jsx)(t.code,{children:"yarn ios"})]}),"\n"]})]}),(0,r.jsxs)(l.Z,{value:"android",children:[(0,r.jsxs)(t.p,{children:["Set the ",(0,r.jsx)(t.code,{children:"newArchEnabled"})," property to ",(0,r.jsx)(t.code,{children:"true"})," by ",(0,r.jsx)(t.strong,{children:"either"}),":"]}),(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Changing the corresponding line in ",(0,r.jsx)(t.code,{children:"android/gradle.properties"})]}),"\n",(0,r.jsxs)(t.li,{children:["Setting the environment variable ",(0,r.jsx)(t.code,{children:"ORG_GRADLE_PROJECT_newArchEnabled=true"})]}),"\n"]}),(0,r.jsx)(t.p,{children:"Then build and run the app as usual:"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:"yarn android\n"})}),(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsxs)(t.p,{children:["You may notice longer build times with the New Architecture due to additional step of C++ compilation with the Android NDK. To improve your build time, see ",(0,r.jsx)(t.a,{href:"/docs/0.72/build-speed",children:"Speeding Up Your Build Phase"}),"."]})})]})]}),"\n",(0,r.jsx)(t.h3,{id:"confirming-the-new-architecture-is-in-use",children:"Confirming the New Architecture is in Use"}),"\n",(0,r.jsxs)(t.p,{children:["After you build and run the app when Metro serves the JavaScript bundle, you should see ",(0,r.jsx)(t.code,{children:'"fabric": true'})," in the Metro logs:"]}),"\n",(0,r.jsx)("img",{src:"/docs/assets/metro-new-arch.png",alt:"Metro shows fabric: true",width:"600"}),"\n",(0,r.jsx)(t.h3,{id:"want-to-know-more",children:"Want to Know More?"}),"\n",(0,r.jsxs)(t.p,{children:["If you'd like to view the code changes relevant to the New Architecture, take a look at the ",(0,r.jsx)(t.a,{href:"https://react-native-community.github.io/upgrade-helper/?from=0.67.4&to=0.68.0",children:"upgrade helper from version 0.67.4 to 0.68.0"}),". Files that were added for the New Architecture are marked with a yellow banner."]}),"\n",(0,r.jsxs)(t.p,{children:["For further explanations of what each file is doing, check out these guides to walk through the changes step-by-step: ",(0,r.jsx)(t.a,{href:"/docs/0.72/new-architecture-app-intro",children:"Enabling The New Architecture in Your App"})]})]})}const m=function(e={}){const{wrapper:t}=Object.assign({},(0,a.ah)(),e.components);return t?(0,r.jsx)(t,Object.assign({},e,{children:(0,r.jsx)(f,e)})):f(e)}},86386:(e,t,n)=>{n.d(t,{Z:()=>h});var r=n(27378),a=n(38944);const i={tabItem:"tabItem_wHwb"};var l=Object.defineProperty,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,u=(e,t,n)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,d=(e,t)=>{for(var n in t||(t={}))s.call(t,n)&&u(e,n,t[n]);if(o)for(var n of o(t))c.call(t,n)&&u(e,n,t[n]);return e};function h({children:e,hidden:t,className:n}){return r.createElement("div",d({role:"tabpanel",className:(0,a.Z)(i.tabItem,n)},{hidden:t}),e)}},48375:(e,t,n)=>{n.d(t,{Z:()=>q});var r=n(27378),a=n(38944),i=n(12112),l=n(3620),o=n(69490),s=n(14953),c=n(27886),u=n(7106),d=Object.defineProperty,h=Object.defineProperties,p=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,v=(e,t,n)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,g=(e,t)=>{for(var n in t||(t={}))f.call(t,n)&&v(e,n,t[n]);if(b)for(var n of b(t))m.call(t,n)&&v(e,n,t[n]);return e},w=(e,t)=>h(e,p(t));function j(e){var t,n;return null!=(n=null==(t=r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})))?void 0:t.filter(Boolean))?n:[]}function x(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=null!=t?t:function(e){return j(e).map((({props:{value:e,label:t,attributes:n,default:r}})=>({value:e,label:t,attributes:n,default:r})))}(n);return function(e){const t=(0,c.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function y({value:e,tabValues:t}){return t.some((t=>t.value===e))}function N({queryString:e=!1,groupId:t}){const n=(0,l.k6)(),a=function({queryString:e=!1,groupId:t}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=t?t:null}({queryString:e,groupId:t});return[(0,s._X)(a),(0,r.useCallback)((e=>{if(!a)return;const t=new URLSearchParams(n.location.search);t.set(a,e),n.replace(w(g({},n.location),{search:t.toString()}))}),[a,n])]}function k(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,i=x(e),[l,s]=(0,r.useState)((()=>function({defaultValue:e,tabValues:t}){var n;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!y({value:e,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const r=null!=(n=t.find((e=>e.default)))?n:t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:i}))),[c,d]=N({queryString:n,groupId:a}),[h,p]=function({groupId:e}){const t=function(e){return e?`docusaurus.tab.${e}`:null}(e),[n,a]=(0,u.Nk)(t);return[n,(0,r.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:a}),b=(()=>{const e=null!=c?c:h;return y({value:e,tabValues:i})?e:null})();(0,o.Z)((()=>{b&&s(b)}),[b]);return{selectedValue:l,selectValue:(0,r.useCallback)((e=>{if(!y({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);s(e),d(e),p(e)}),[d,p,i]),tabValues:i}}var O=n(14185);const E={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var A=Object.defineProperty,S=Object.defineProperties,C=Object.getOwnPropertyDescriptors,P=Object.getOwnPropertySymbols,_=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,T=(e,t,n)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,D=(e,t)=>{for(var n in t||(t={}))_.call(t,n)&&T(e,n,t[n]);if(P)for(var n of P(t))I.call(t,n)&&T(e,n,t[n]);return e},R=(e,t)=>S(e,C(t));function V({className:e,block:t,selectedValue:n,selectValue:l,tabValues:o}){const s=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.o5)(),u=e=>{const t=e.currentTarget,r=s.indexOf(t),a=o[r].value;a!==n&&(c(t),l(a))},d=e=>{var t,n;let r=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const n=s.indexOf(e.currentTarget)+1;r=null!=(t=s[n])?t:s[0];break}case"ArrowLeft":{const t=s.indexOf(e.currentTarget)-1;r=null!=(n=s[t])?n:s[s.length-1];break}}null==r||r.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":t},e)},o.map((({value:e,label:t,attributes:i})=>r.createElement("li",R(D({role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,key:e,ref:e=>s.push(e),onKeyDown:d,onClick:u},i),{className:(0,a.Z)("tabs__item",E.tabItem,null==i?void 0:i.className,{"tabs__item--active":n===e})}),null!=t?t:e))))}function L({lazy:e,children:t,selectedValue:n}){const a=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){const e=a.find((e=>e.props.value===n));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},a.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==n}))))}function Z(e){const t=k(e);return r.createElement("div",{className:(0,a.Z)("tabs-container",E.tabList)},r.createElement(V,D(D({},e),t)),r.createElement(L,D(D({},e),t)))}function q(e){const t=(0,O.Z)();return r.createElement(Z,D({key:String(t)},e),j(e.children))}},11674:(e,t,n)=>{n.d(t,{Z:()=>l});var r=n(63445);const a=!!r.Z.canUseDOM&&navigator.platform.startsWith("Mac"),i=!!r.Z.canUseDOM&&navigator.platform.startsWith("Win"),l={defaultGuide:"quickstart",defaultJsDebugger:"flipper",defaultOs:a?"macos":i?"windows":"linux",defaultPackageManager:"npm",defaultPlatform:a?"ios":"android",defaultSyntax:"functional",defaultAndroidLanguage:"java",defaultJavaScriptSpecLanguages:"typescript",getDevNotesTabs:(e=["android","ios","web","windows"])=>[e.includes("android")?{label:"Android",value:"android"}:void 0,e.includes("ios")?{label:"iOS",value:"ios"}:void 0,e.includes("web")?{label:"Web",value:"web"}:void 0,e.includes("windows")?{label:"Windows",value:"windows"}:void 0].filter(Boolean),guides:[{label:"Expo Go Quickstart",value:"quickstart"},{label:"React Native CLI Quickstart",value:"native"}],oses:[{label:"macOS",value:"macos"},{label:"Windows",value:"windows"},{label:"Linux",value:"linux"}],packageManagers:[{label:"npm",value:"npm"},{label:"Yarn",value:"yarn"}],platforms:[{label:"Android",value:"android"},{label:"iOS",value:"ios"}],syntax:[{label:"Function Component",value:"functional"},{label:"Class Component",value:"classical"}],androidLanguages:[{label:"Java",value:"java"},{label:"Kotlin",value:"kotlin"}],javaScriptSpecLanguages:[{label:"TypeScript",value:"typescript"},{label:"Flow",value:"flow"}],jsDebuggers:[{label:"Hermes Debugger / Expo",value:"hermes"},{label:"Flipper",value:"flipper"},{label:"New Debugger (Experimental)",value:"new-debugger"}],snackLanguages:[{label:"TypeScript",value:"typescript"},{label:"JavaScript",value:"javascript"}],defaultSnackLanguage:"typescript"}},71426:(e,t,n)=>{var r=n(27378),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)l.call(t,r)&&!s.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:u,props:i,_owner:o.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},24246:(e,t,n)=>{e.exports=n(71426)},71670:(e,t,n)=>{n.d(t,{Zo:()=>o,ah:()=>i});var r=n(27378);const a=r.createContext({});function i(e){const t=r.useContext(a);return r.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}const l={};function o({components:e,children:t,disableParentContext:n}){let o;return o=n?"function"==typeof e?e({}):e||l:i(e),r.createElement(a.Provider,{value:o},t)}}}]);